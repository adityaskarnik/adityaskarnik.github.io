<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>Docker Compose Basic Tutorial - Aditya Karnik</title>
        <!-- SEO Meta Tags-->
        <meta name="description" content="Introduction and Overview of Compose. Running Multi-Container Application with Docker Compose, create and start using one command. Deploy on local system or cloud">
        <meta name="keywords" content="documentation, docs, docker, compose, orchestration, containers, kubernetes, docker compose, aditya karnik">
        <meta name="author" content="Aditya Karnik">
        <!-- Viewport-->
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <!-- Font Ubuntu -->
        <link rel="preconnect" href="https://fonts.gstatic.com">
        <link rel="stylesheet preload prefetch" as="font" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@300&display=swap" crossorigin="anonymous">
        <link rel="stylesheet preload prefetch" as="font" href="../assets/font/Marvelous-Script-Demo.otf" crossorigin="anonymous">
        <link rel="preload"
            as="style"
            onload="this.rel = 'stylesheet'" href="../assets/font/font-awesome.min.css">
        <link rel="preload"
            as="style"
            onload="this.rel = 'stylesheet'" href="../assets/font/font-awesome.css">
        <!-- Favicon and Touch Icons-->
        <link rel="apple-touch-icon" sizes="57x57" href="../assets/images/apple-icon-57x57.png">
        <link rel="apple-touch-icon" sizes="60x60" href="../assets/images/apple-icon-60x60.png">
        <link rel="apple-touch-icon" sizes="72x72" href="../assets/images/apple-icon-72x72.png">
        <link rel="apple-touch-icon" sizes="76x76" href="../assets/images/apple-icon-76x76.png">
        <link rel="apple-touch-icon" sizes="114x114" href="../assets/images/apple-icon-114x114.png">
        <link rel="apple-touch-icon" sizes="120x120" href="../assets/images/apple-icon-120x120.png">
        <link rel="apple-touch-icon" sizes="144x144" href="../assets/images/apple-icon-144x144.png">
        <link rel="apple-touch-icon" sizes="152x152" href="../assets/images/apple-icon-152x152.png">
        <link rel="apple-touch-icon" sizes="180x180" href="../assets/images/apple-icon-180x180.png">
        <link rel="icon" type="image/png" sizes="192x192"  href="../assets/images/android-icon-192x192.png">
        <link rel="icon" type="image/png" sizes="32x32" href="../assets/images/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="96x96" href="../assets/images/favicon-96x96.png">
        <link rel="icon" type="image/png" sizes="16x16" href="../assets/images/favicon-16x16.png">
        <link rel="manifest" href="../assets/images/manifest.json">
        <meta name="msapplication-TileColor" content="#ffffff">
        <meta name="msapplication-TileImage" content="/ms-icon-144x144.png">
        <meta name="theme-color" content="#ffffff">
        <link rel="manifest" href="../assets/images/logo/site.webmanifest">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <style>
            @font-face {
            font-family: Marvelous-Script-Demo;
            font-display: swap;
            src:url("..\\assets\\font\\Marvelous-Script-Demo.otf");
            }
            .logo-text {
            font-family: Marvelous-Script-Demo;
            font-size: 320%;
            width: 100%;
            height: auto;
            text-align: center;
            color: #ffc602;
            font-display: swap;
            }
            * {
            font-family: 'Ubuntu', sans-serif;
            font-display: swap;
            }
            body {
            font-family: 'Ubuntu', sans-serif;
            font-display: swap;
            }
            .cs-page-loading {
            position: fixed;
            top: 0;
            right: 0;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 100%;
            -webkit-transition: all .4s .2s ease-in-out;
            transition: all .4s .2s ease-in-out;
            background-color: #fff;
            opacity: 0;
            visibility: hidden;
            z-index: 9999;
            }
            .cs-page-loading.active {
            opacity: 1;
            visibility: visible;
            }
            .cs-page-loading-inner {
            position: absolute;
            top: 50%;
            left: 0;
            width: 100%;
            text-align: center;
            -webkit-transform: translateY(-50%);
            transform: translateY(-50%);
            -webkit-transition: opacity .2s ease-in-out;
            transition: opacity .2s ease-in-out;
            opacity: 0;
            }
            .cs-page-loading.active > .cs-page-loading-inner {
            opacity: 1;
            }
            .cs-page-loading-inner > span {
            display: block;
            font-family: 'Ubuntu', sans-serif;
            font-size: 1rem;
            font-weight: normal;
            color: #737491;
            font-display: swap;
            }
            .cs-page-spinner {
            display: inline-block;
            width: 2.75rem;
            height: 2.75rem;
            margin-bottom: .75rem;
            vertical-align: text-bottom;
            border: .15em solid #766df4;
            border-right-color: transparent;
            border-radius: 50%;
            -webkit-animation: spinner .75s linear infinite;
            animation: spinner .75s linear infinite;
            }
            @-webkit-keyframes spinner {
            100% {
            -webkit-transform: rotate(360deg);
            transform: rotate(360deg);
            }
            }
            @keyframes spinner {
            100% {
            -webkit-transform: rotate(360deg);
            transform: rotate(360deg);
            }
            }
            iframe {
            overflow:hidden;
            }
            code {
            font-family: 'Ubuntu', sans-serif;
            font-display: swap;
            }
            pre {
            font-family: 'Ubuntu', sans-serif;
            font-display: swap;
            }
            li.L0, li.L1, li.L2, li.L3,
            li.L5, li.L6, li.L7, li.L8 {
            list-style-type: decimal !important;
            }
        </style>
        <script async src="https://use.fontawesome.com/449fc92c63.js"></script>
        <!-- Vendor Styles-->
        <link rel="stylesheet preload" as="style" media="screen" href="../assets/css/simplebar.min.css">
        <link rel="stylesheet preload" as="style" media="screen" href="../assets/css/tiny-slider.css">
        <link rel="stylesheet preload" as="style" media="screen" href="../assets/css/lightgallery.min.css">
        <!-- Main Theme Styles + Bootstrap-->
        <link rel="stylesheet preload" as="style" media="screen" href="../assets/css/theme.min.css">
        <!-- Google analytics -->
        <script async custom-element="amp-analytics" src="https://cdn.ampproject.org/v0/amp-analytics-0.1.js"></script>
        <!-- Global site tag (gtag.js) - Google Ads: 942098851 -->
        <script async src="https://www.googletagmanager.com/gtag/js?id=AW-942098851"></script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
            
            gtag('config', 'AW-942098851');
        </script>
        <!-- Event snippet for Website traffic conversion page -->
        <script>
            gtag('event', 'conversion', {'send_to': 'AW-942098851/xQJACJqMsO0BEKOTncED'});
        </script>
        <!-- Global site tag (gtag.js) - Google Analytics -->
        <script async src="https://www.googletagmanager.com/gtag/js?id=UA-173927461-1"></script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
            
            gtag('config', 'UA-173927461-1');
        </script>
        <!-- Google Tag Manager -->
        <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
            new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
            j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
            'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
            })(window,document,'script','dataLayer','GTM-MWL6PRR');
        </script>
        <!-- End Google Tag Manager -->
    </head>
    <!-- Body -->
    <body>
        <!-- Google Tag Manager (noscript) -->
        <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-MWL6PRR" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
        <!-- End Google Tag Manager (noscript) -->
        <!-- Global site tag (gtag) - Google Ads: 942098851 --> <amp-analytics type="gtag" data-credentials="include"> <script type="application/json"> { "vars": { "gtag_id": "AW-942098851", "config": { "AW-942098851": { "groups": "default" } } }, "triggers": { "C_JVmPciA7KpY": { "on": "visible", "vars": { "event_name": "conversion", "send_to": ["AW-942098851/xQJACJqMsO0BEKOTncED"] } }} } </script> </amp-analytics>
        <!-- Page loading spinner-->
        <main class="cs-page-wrapper">
            <!-- Navbar Floating light for Index page only-->
            <!-- Remove "navbar-sticky" class to make navigation bar scrollable with the page.-->
            <header class="cs-header navbar navbar-expand-lg navbar-light bg-light navbar-box-shadow navbar-sticky" data-scroll-header="">
                <div class="container px-0 px-xl-3">
                    <button class="navbar-toggler ml-n2 mr-2" type="button" data-toggle="offcanvas" data-offcanvas-id="primaryMenu">
                        <span class="navbar-toggler-icon"></span>
                    </button>
                    <a class="navbar-brand order-lg-1 mx-auto ml-lg-0 pr-lg-2 mr-lg-4" href="/">
                    <img class="lazyload d-none d-lg-block" width="153" src="../assets/images/logo-dark.png" alt="aditya karnik">
                    <img class="d-lg-none" width="58" src="../assets/images/logo-icon.png" alt="aditya karnik">
                    <div class="d-flex align-items-center order-lg-3 ml-lg-auto">
                        <a class="btn btn-primary ml-grid-gutter d-none d-lg-inline-block" href="https://github.com/adityaskarnik" target="_blank" rel="noopener noreferrer">
                        <i class="fa fa-github" aria-hidden="true"></i> View <span class="d-none d-lg-inline">Profile</span>
                        </a>
                    </div>
                    <div class="cs-offcanvas-collapse order-lg-2" id="primaryMenu">
                        <div class="cs-offcanvas-cap navbar-box-shadow">
                            <h5 class="mt-1 mb-0">Menu</h5>
                            <button class="close lead" type="button" data-toggle="offcanvas" data-offcanvas-id="primaryMenu"><span aria-hidden="true">×</span></button>
                        </div>
                        <div class="cs-offcanvas-body">
                            <!-- Menu-->
                            <ul class="navbar-nav">
                                <li class="nav-item dropdown dropdown-mega"><a class="nav-link dropdown-toggle" href="/" >Home</a></li>
                                <li class="nav-item dropdown dropdown-mega"><a class="nav-link dropdown-toggle" href="/blog">Blog</a></li>
                                <li class="nav-item dropdown dropdown-mega"><a class="nav-link" href="/contact">Contact</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </header>
            <!-- Page content-->
            <section class="container">
                <h1 class="h1 pt-4 pt-md-5 mt-2">Docker and Docker Compose</h1>
                <div class="d-sm-flex alitgn-itams-center pt-3 font-size-sm">
                    <div class="d-flex align-items-center mb-3">
                        <div class="text-nowrap text-muted mr-3"><i class="fa fa-calendar mr-1"></i><span>Mar 13 2021</span></div>
                        <div class="text-nowrap text-muted"><i class="fa fa-tag mr-1"></i><span>Virtualization</span></div>
                    </div>
                    <div class="col-md-10 order-md-2 text-md-right mb-3">
                        <ul class="list-inline font-size-sm mb-0">
                            <a class="social-btn sb-outline sb-facebook mr-2 my-2" href="https://www.facebook.com/sharer/sharer.php?u=https://adityakarnik.com/blog/docker_compose">
                                <i class="fa fa-facebook"></i>
                            </a>
                            <a class="social-btn sb-outline sb-twitter mr-2 my-2" href="https://twitter.com/intent/tweet?text=An easy tutorial to get you started with ChatBot Web API https://adityakarnik.com/blog/docker_compose @aditya_karnik #chatbotrasa">
                                <i class="fa fa-twitter"></i>
                            </a>
                            <a class="social-btn sb-outline sb-google mr-2 my-2" href="https://www.linkedin.com/shareArticle?mini=true&url=https://adityakarnik.com/blog/docker_compose&title=&summary=&source=">
                                <i class="fa fa-linkedin"></i>
                            </a>
                            <a class="social-btn sb-outline sb-pinterest mr-2 my-2" href="https://pinterest.com/pin/create/button/?url=https://adityakarnik.com/blog/docker_compose&media=&description=">
                                <i class="fa fa-pinterest"></i>
                            </a>
                            <a class="social-btn sb-outline sb-whatsapp my-2" href="whatsapp://send?text=Checkout this page https://adityakarnik.com/blog/docker_compose" data-action="share/whatsapp/share">
                                <i class="fa fa-whatsapp"></i>
                            </a>
                        </ul>
                      </div>
                </div>
            </section>
            <div class="container">
                <div class="row justify-content-center">
                    <div class="col-lg-5 cs-sidebar pt-2 pt-lg-5 pb-lg-5 order-lg-1">
                        <img src="../assets/images/docker.png" alt="Docker Image"/>
                    </div>
                    <div class="col-lg-7 cs-content pt-5 pt-lg-5 order-lg-2">
                        <h5>Shoot</h5>
                        <p class="py-1 font-size-lg mb-4 pb-2">Imagine, you have an application running on your system and a database on a different server. Did you imagine? Right, now lets say you need to deploy it on a live server, on AWS or GCP or Azure, how exciting, right?</p>
                        <p class="py-1 font-size-lg mb-4 pb-2">Let me give you a bigger picture, you need to take all the steps you did to setup your application or you have multiple servers where you will need to setup this application. Same number of steps again and again. Darn it.</p>
                        <p class="py-1 font-size-lg mb-4 pb-2">Similarly you make changes to the now running application. Won't you think it will be too troublesome to update it. </p>
                        <p class="py-1 font-size-lg mb-4 pb-2">Not just that, the environment settings, application stack you use. Tools that are required need to be ready before deploying. So much complexity, the architecture.</p>
                        <p class="py-1 font-size-lg mb-4 pb-2">The biggest challenge, "IT WORKS ON MY SYSTEM" 🤷</p>
                    </div>
                </div>
                <div class="row justify-content-center">
                    <div class="col-lg-9 py-4 mb-2 mb-sm-0 pb-sm-5">
                        <h5>Okay, I get it</h5>
                        <p class="py-1 font-size-lg mb-4 pb-2">If I may suggest, Hello Docker!</p>
                        <p class="py-1 font-size-lg mb-4 pb-2">Lot of resources on the internet will tell you, why do you need to use Docker if you are developer; A very few of them:</p>
                        <ol>
                            <li>Portability</li>
                            <li>Scalability</li>
                            <li>Faster configuration</li>
                            <li>CI/CD</li>
                            <li>Logging at its best.</li>
                        </ol>
                        <p class="py-1 font-size-lg mb-4 pb-2">Here's a basic idea about Docker and Docker Compose</p>
                        <img src="../assets/images/docker_and_docker_compose.png" alt="Docker Compose"/>
                        <p class="py-1 font-size-lg mt-2 mb-4 pb-2">Without wasting anymore time, </p>
                        <h4>Let's Dockerize</h4>
                        <p class="py-1 font-size-lg mb-4 pb-2">Hoping you have already installed Docker on your system, we will begin, If not you can quickly install it from <a class="nav-link-style nav-link-style" href="https://docs.docker.com/engine/install/" target="_blank" rel="noopener noreferrer">here</a></p>
                        <p class="py-1 font-size-lg mb-4 pb-2">Firstly, we shall understand how to setup a Single container using <code style="font-family: Ubuntu;">Docker</code> and<code style="font-family: Ubuntu;"> Dockerfile</code></p>
                        <p class="py-1 font-size-lg mb-4 pb-2">Following are the command you will need to run on your command prompt</p>
                        <p>To list of all the local images</p>
                        <code class="row cs-sidebar col-lg-12 py-3 mb-2 mb-sm-3 pb-sm-3 rounded" style="font-family: Ubuntu;">docker images</code>
                        <p>The <code style="font-family: Ubuntu;">docker ps</code> command only shows running containers by default.</p>
                        <p>To see all containers, use the -a (or --all) flag:</p>
                        <code class="row cs-sidebar col-lg-12 py-3 mb-2 mb-sm-3 pb-sm-3 rounded" style="font-family: Ubuntu;">docker ps -a</code>
                        <p>To create a container and kick start it</p>
                        <code class="row cs-sidebar col-lg-12 py-3 mb-2 mb-sm-3 pb-sm-3 rounded" style="font-family: Ubuntu;">docker run -it -v {/path/to/your/project/directory/or/home/directory}:{docker/container/path/} -p 9012:9012 {image_name}</code>
                        <ol>
                            <li><code style="font-family: Ubuntu;">-i</code> - interactive shell, as in command line access to the container</li>
                            <li><code style="font-family: Ubuntu;">-t</code> - terminal, or tty</li>
                            <li><code style="font-family: Ubuntu;">-v</code> - the volume path - the first in the host path, that is the local system path that you want the docker container to map to : - the next part is the path inside the container that you wish to login to directly</li>
                            <li><code style="font-family: Ubuntu;">-p</code> - this is the port forwarding for the container from the local or host machine.</li>
                            <li><code style="font-family: Ubuntu;">{image_name}</code> - is the docker image that you want to run and get access</li>
                        </ol>
                        <p class="py-1 font-size-lg mb-4 pb-2">After successfully running this command you will get inside the container to the specified path. You can either <code style="font-family: Ubuntu;">exit</code> the container and stop it or you can <code style="font-family: Ubuntu;">Ctrl+D</code> to leave it running and exit. To make this sure you need to run the previous <code style="font-family: Ubuntu;">docker ps</code> to check if it is running</p>
                        <p>To start a container that is in Existed state, First you need get the CONTAINER ID</p>
                        <code class="row cs-sidebar col-lg-12 py-3 mb-2 mb-sm-3 pb-sm-3 rounded" style="font-family: Ubuntu;">docker ps -a</code>
                        <p>Check the output:</p>
                        <code class="row cs-sidebar col-lg-12 py-3 mb-2 mb-sm-3 pb-sm-3 rounded" style="font-family: Ubuntu;">CONTAINER ID&emsp;  IMAGE&emsp;   COMMAND&emsp;     CREATED&emsp;&emsp;STATUS&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;PORTS&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;NAMES
                            <br>29a462eea79c&emsp;     ubuntu&emsp;      "/bin/bash"&emsp;     4 days ago&emsp;      Exited (255) 3 days ago&emsp;     0.0.0.0:9010-9012->9010-9012/tcp&emsp;    ubuntu</code>
                        <p>Use the CONTAINER ID along with it to start the container</p>
                        <code class="row cs-sidebar col-lg-12 py-3 mb-2 mb-sm-3 pb-sm-3 rounded" style="font-family: Ubuntu;">docker start 29a462eea79c</code>
                        <a name="attach"></a><p>To get access to the started or already running container you need to:</p>
                        </a><code class="row cs-sidebar col-lg-12 py-3 mb-2 mb-sm-3 pb-sm-3 rounded" style="font-family: Ubuntu;">docker attach 29a462eea79c</code>
                        <ul><li>This will lead you the same thing as you get after use the <code style="font-family: Ubuntu;">docker run</code></li></ul>
                        <p>To stop a running container you need to:</p>
                        <code class="row cs-sidebar col-lg-12 py-3 mb-2 mb-sm-3 pb-sm-3 rounded" style="font-family: Ubuntu;">docker stop 29a462eea79c</code>
                        <p>To delete the created docker container you need to:</p>
                        <code class="row cs-sidebar col-lg-12 py-3 mb-2 mb-sm-3 pb-sm-3 rounded" style="font-family: Ubuntu;">docker rm 29a462eea79c</code>
                        <p class="py-1 font-size-lg mb-4 pb-2">Lets consider you need to create a container, customised for your own project. You have to create a <strong>Dockerfile</strong> which will have a basic setup ready for you to use when you login into that container. Giving an example of installing and running a basic Python application</p>
                        <p>Open a new file named <code style="font-family: Ubuntu;">Dockerfile</code> in any Editor. You need not give any dot extension to this file. Paste the content given below:</p>
                        <pre style="font-family: Ubuntu;"><code># Download base image ubuntu 18.04
FROM ubuntu:18.04

# Most important of all give this your own name
MAINTAINER adityakarnik

# This will give you all the latest updates and required packages to start
RUN apt-get update \
    && apt-get install -my wget gnupg \
    && apt-get install -y --no-install-recommends \
        apt-utils \
        ca-certificates \
        apt-transport-https \
        jq \
        numactl \
&& rm -rf /var/lib/apt/lists/*

RUN apt-get update

# Installing python and its dependencies
RUN apt-get install -y python-pip python-dev build-essential

# Copy the local folder of your app to docker container
# Consider this app folder in placed in the same folder as your Dockerfile
COPY app/ /app

# Navigate to yoru app directory
WORKDIR /app

# Install you application dependencies
RUN pip install -r requirements.txt

# This will the command run when you start your container
ENTRYPOINT ["python"]

# Like "python app.py", this will run when you start your container
CMD ["app.py"]</code></pre>
                        <p class="py-1 font-size-lg mb-4 pb-2">Let's understand what have done here</p>
                        <ol>
                            <li><code style="font-family: Ubuntu;">FROM</code> - Choose a pre-built base image from which you wish to start working on. For this example I selected the Ubuntu image</li>
                            <li><code style="font-family: Ubuntu;">MAINTAINER</code> - The author of the yaml file</li>
                            <li><code style="font-family: Ubuntu;">RUN</code> - This is similar to when you execute a command on your command prompt. We execute a few pre-requisites, fetch the latest packages with <pre style="font-family: Ubuntu;"><code>apt-get update</code></pre>. And lastly we install the required python tool</li>
                            <li><code style="font-family: Ubuntu;">COPY</code> - This will place the same content you have in the given folder, which is your code project files, ready to run. It states that the whole content from /app needs to be synced with the app/ folder inside the container, once created.</li>
                            <li><code style="font-family: Ubuntu;">WORKDIR</code> - This is like you navigate to the folder ready to run the project. Just like your <pre style="font-family: Ubuntu;"><code>change directory (cd)</code></pre> command.</li>
                            <li><code style="font-family: Ubuntu;">RUN</code> - next it will install the packages from the requirement.txt file with help of pip - package installer program of python</li>
                            <li><code style="font-family: Ubuntu;">ENTRYPOINT</code> - is the command or parent command that you wish to run when you start the container, in this case <pre style="font-family: Ubuntu;"><code>python</code></pre></li>
                            <li><code style="font-family: Ubuntu;">CMD</code> - this is sub command, child command that you wish to execute after he python command above. Like <pre style="font-family: Ubuntu;"><code>python app.py</code></pre>These are a list of command, where each command is separated with a space.</li>
                        </ol>
                        <p class="py-1 font-size-lg mb-4 pb-2">Next we will run and complete the execution and fire up the container</p>
                        <p>Building the image from Dockerfile</p>
                        <code class="row cs-sidebar col-lg-12 py-3 mb-2 mb-sm-3 pb-sm-3 rounded" style="font-family: Ubuntu;">docker build --no-cache -t python .</code>
                        <ul><li>We gave the name, python to the image, you can choose whatever you wish to</li></ul>
                        <p>Start the container from the image that is created.</p>
                        <code class="row cs-sidebar col-lg-12 py-3 mb-2 mb-sm-3 pb-sm-3 rounded" style="font-family: Ubuntu;">docker run -p 5000:5000 --name python python</code>
                        <ul><li>Here we have exposed the port number 5000 inside out the container for accessing the application outside the container</li></ul>
                        <p>Now you can check and confirm your application will be running on port 5000. <a href="#attach">To attach the container you can check the previous command</a></p>
                        <p>And this is how we run a dockerfile for single application execution. Let's also check how to stop and remove the containers</p>
                        <code class="row cs-sidebar col-lg-12 py-3 mb-2 mb-sm-3 pb-sm-3 rounded" style="font-family: Ubuntu;">sudo docker rm $(sudo docker ps -a -q) && sudo docker rmi $(sudo docker images -q)</code>
                        <p class="py-1 font-size-lg mb-4 pb-2">Now consider you have made a some changes to your environment and you need to deploy the same currently working docker to another system or make a clone of it as test environment. You will need to commit the docker</p>
                        <p>Committing the current state of the container:</p>
                        <code class="row cs-sidebar col-lg-12 py-3 mb-2 mb-sm-3 pb-sm-3 rounded" style="font-family: Ubuntu;">docker commit 4cb998fee815 [give_it_a_name]</code>
                        <p>Creating a zip file of the container:</p>
                        <code class="row cs-sidebar col-lg-12 py-3 mb-2 mb-sm-3 pb-sm-3 rounded" style="font-family: Ubuntu;">docker save -o [file_name.tar] [the_given_name]</code>
                        <p class="py-1 font-size-lg mb-4 pb-2">Well, congratulations, now you can create your own single image container using Dockerfile. <a class="nav-link-style nav-link-style" href="https://docs.docker.com/engine/reference/builder/#environment-replacement" target="_blank" rel="noopener noreferrer">For more commands and references in Dockerfile refer here</a></p>
                        <p class="py-1 font-size-lg mb-4 pb-2">Let's move to our next section</p>
                        <h3>Docker Compose</h3>
                        <p class="py-1 font-size-lg mb-4 pb-2">We will quickly understand the What Why How.</p>
                        <ol>
                            <li><p class="py-1 font-size-lg mb-4 pb-2">Docker Compose is a next step in running a container, the only difference here is that you can fire up multiple containers at a time, where as with Dockerfile you can have only a single containers. With the use of a YAML file, setup the server for your application, with just a single command.</p></li>
                            <li><p class="py-1 font-size-lg mb-4 pb-2">Call your imaginative powers again and think, if you had multi-server application, say a Application server, Database container, Worker where all the heavy lifting is done and Log server. How easy will it be to manage all of it from one file and with only a single command. Fancy? And it does work in all the systems take your test environment for example, once tested and working fine you will need to replicate the same environment on production.</p></li>
                            <li><p class="py-1 font-size-lg mb-4 pb-2">One single command from the directory where you have a your <code style="font-family: Ubuntu;">docker-compose.yml</code> file, you run <code style="font-family: Ubuntu;">docker-compose up</code> and voila, you have it all in a couple of minutes ready. Similar to Dockerfile you will have to define a few steps, the only difference is that, you will make use of the Dockerfile in the compose file or an pre-build image.</p></li>
                        </ol>
                        <p class="py-1 font-size-lg mb-4 pb-2">The sample file looks something like this:</p>
                        <pre style="font-family: Ubuntu;"><code>version: 3.8
services:
    web:
        build: .
        ports:
            - "5000:5000"
        volumes:
            - .:/code
            - log:/var/log
        links:
            - rabbitmq
    rabbitmq:
        image: "rabbitmq:3-management"</code></pre>
                        <p class="py-1 font-size-lg mb-4 mt-4 pb-2">I suppose you already have Docker Compose on your system, we will begin, If not you can quickly install it from <a class="nav-link-style nav-link-style" href="https://docs.docker.com/compose/install/" target="_blank" rel="noopener noreferrer">here</a></p>
                        <p class="py-1 font-size-lg mb-4 pb-2">Setting some realistic goals to understand Compose, lets have a problem statement in mind.</p>
                        <p>
                            <ul>
                                <li>We have a Django application which runs on port 8100</li>
                                <li>This application has another process which runs Celery tasks in background to continuously check some updates</li>
                                <li>There is a postgres database running separately</li>
                                <li>There is rabbitmq, required for queueing purpose</li>
                                <li>Also it has Elasticsearch and Kibana running for pushing data and logs, both running independently</li>
                            </ul>
                        </p>
                        <p>Sounds fun? Let's get on with it.</p>
                        <p>Create a blank <code style="font-family: Ubuntu;">docker-compose.yml</code></p>
                        <p>First thing you define is the version number, depending on your your Docker engine that you have installed you will need to use that version for the compose file. 
                            This is just the syntax format, difference in most versions, not all necessarily.</p>
                            <pre style="font-family: Ubuntu;"><code>version: 3.8</code></pre>
                        <p>Now your file looks something like this</p>
                        <p>Next we define the Services section which is basically the different containers you wish to run, in our case six different containers with their own process setup</p>
                        <p>Name the service with something that it represents or does. Our first service is the Django application, we will define it's name as <code style="font-family: Ubuntu;">web</code>. As stated before we will need to create a <code style="font-family: Ubuntu;">Dockerfile</code> and state it in build.</p>
                        <p>Let's create a Dockerfile</p>
                        <pre style="font-family: Ubuntu;"><code>FROM python:3.7

MAINTAINER adityakarnik

COPY . /app/

WORKDIR /app

RUN pip install -r requirements.txt

EXPOSE 8100</code></pre>
                        <p>Nothing serious, a simple file with simple syntax we discussed before, the app is already prepared and we will not go into the app code, as its off topic.</p>
                        <p>Next we get back to the compose file, stating what we have now, the Dockerfile and what is required for it.</p>
                        <pre style="font-family: Ubuntu;"><code>version: 3.8
services:
  web_app:  # 1
    build:  # 2
      context: .    # 3
      dockerfile: Dockerfile # 4
    command: bash -c "python manage.py makemigrations && python manage.py migrate && python manage.py runserver 0.0.0.0:8100"   # 5
    volumes: # 6
      - .:/app
      - /root/db/:/root/db/
    ports:  # 7
      - "8100:8100"
    environment:    # 8
      APP_PASSWORD: "${APP_PASSWORD}"
      POSTGRES_PASSWORD: "${POSTGRES_PASSWORD}"
      ELASTIC_PASSWORD: "${ELASTIC_PASSWORD}"
    depends_on: # 9
      - web_worker
      - elasticsearch
    container_name: django_app # 10
    networks:   # 11
      web_network:  # 12
        ipv4_address: "10.10.10.2"
    restart:    # 13
      always    # 14</code></pre>
                        <p>WOW!! There was just a single version line in there, now its like a hundreds of line of code? Yup, I have just created a that for you, we will look at each line in detail</p>
                        <p><ol>
                            <li><code style="font-family: Ubuntu;">web_app</code> - Is the name of the service as an identifier this has to be unique. It should generally represent the operation/process is about.</li>
                            <li><code style="font-family: Ubuntu;">build</code> - represents the image or the Dockerfile that you created earlier. This can just be a <code style="font-family: Ubuntu;">.</code> which tell that you need to pick a Dockerfile from the current folder.</li>
                            <li><code style="font-family: Ubuntu;">context</code> - is an optional key. It specifies where it should find the Dockerfile</li>
                            <li><code style="font-family: Ubuntu;">Dockerfile</code> - name of the file you have created, the Dockerfile is standard file name. In case if you have a test environment dockerfile, you can name it something like <code style="font-family: Ubuntu;">Dockerfile.test</code></li>
                            <li><code style="font-family: Ubuntu;">command</code> - key name clearly states what it does. It a command that you wish to execute once the container is up and running</li>
                            <li><code style="font-family: Ubuntu;">volumes</code> - key mounts the project directory (current directory) on the host to /code inside the container, allowing you to modify the code on the fly, without having to rebuild the image.</li>
                            <li><code style="font-family: Ubuntu;">ports</code> - Exposes container ports for mapping. This allows the container and the host to communicate to each other over this port</li>
                            <li><code style="font-family: Ubuntu;">environment</code> - key sets the APP_PASSWORD, POSTGRES_PASSWORD and ELASTIC_PASSWORD environment variable, which tells the application to fetch wherever required these keys from its environment variable collection</li>
                            <li><code style="font-family: Ubuntu;">depends_on</code> - sets the dependencies on another containers on startup and shutdown</li>
                            <li><code style="font-family: Ubuntu;">container_name</code> - it defines the custom container name to be provided to instead of the default auto generated value</li>
                            <li><code style="font-family: Ubuntu;">networks</code> - this key specifier denotes the networks that containers it is attached to and what are their different address allowed for this network. The names provided in this section are to be declared in the top level Networks section as well</li>
                            <li><code style="font-family: Ubuntu;">web_network</code> - name of the network for the current service</li>
                            <li><code style="font-family: Ubuntu;">restart</code> - key denotes the policy it should follow once the container is terminated. There different values such as <pre style="font-family: Ubuntu;"><code>restart: "no"
restart: always
restart: on-failure
restart: unless-stopped</code></pre></li>
                        </ol></p>
                        <p class="py-1 font-size-lg mb-2 pb-2">Now on your command line, run</p>
                        <pre style="font-family: Ubuntu;"><code>docker-compose up</code></pre>
                        <p class="py-1 font-size-lg mt-2 mb-4 pb-2">the container will build, as its the first time, start up and run</p>
                        <p>Let us add more services to move forward next</p>
                        <pre><code>version: 3.8
services:
  web_app:
    build:
      context: .
      dockerfile: Dockerfile
    command: bash -c "python manage.py makemigrations && python manage.py migrate && python manage.py runserver 0.0.0.0:8100"
    volumes:
      - .:/app
      - /root/db/:/root/db/
    ports:
      - "8100:8100"
    environment:
      APP_PASSWORD: "${APP_PASSWORD}"
      POSTGRES_PASSWORD: "${POSTGRES_PASSWORD}"
      ELASTIC_PASSWORD: "${ELASTIC_PASSWORD}"
    depends_on:
      - web_worker
      - elasticsearch
    container_name: django_app
    networks:
      web_network:
        ipv4_address: "10.10.10.2"
    restart:
      always
  web_worker:
    build:
      context: .
      dockerfile: Dockerfile
    command: bash -c "celery worker -A payee_name -l INFO --beat --concurrency=1 -n 'main_app'"
    volumes:
      - .:/app
    ports:
      - "8200:8200"
    environment:
      APP_PASSWORD: "${APP_PASSWORD}"
      POSTGRES_PASSWORD: "${POSTGRES_PASSWORD}"
      ELASTIC_PASSWORD: "${ELASTIC_PASSWORD}"
    links:
      - rabbitmq
    depends_on:
      - rabbitmq
      - elasticsearch
    container_name: web_worker
    networks:
      web_network:
        ipv4_address: "10.10.10.3"
    restart:
      always

  web_db:
    image: "postgres"
    container_name: web_db
    restart: always
    ports:
      - 5432:5432
    environment:
      POSTGRES_HOST: "web_host"
      POSTGRES_PORT: "5432"
      POSTGRES_USER: "web"
      POSTGRES_PASSWORD: "${POSTGRES_PASSWORD}"
      POSTGRES_DB: "Web"
      PG_DATA: "/var/lib/postgresql/data"
    volumes:
      - /var/lib/postgresql/data:/var/lib/postgresql/data
      - ./init.sql:/docker-entrypoint-initdb.d/init.sql
      - ./init-user-db.sh:/docker-entrypoint-initdb.d/init-user-db.sh
    networks:
      web_network:
        ipv4_address: "10.10.10.4"
  
  rabbitmq:
    image: "rabbitmq:3-management"
    hostname: "rabbitmq"
    environment:
      RABBITMQ_ERLANG_COOKIE: "SWQOKODSQALRPCLNMEQG"
      RABBITMQ_DEFAULT_USER: "rabbitmq"
      RABBITMQ_DEFAULT_PASS: "rabbitmq"
      RABBITMQ_DEFAULT_VHOST: "/"
    ports:
      - '5672:5672'
      - '15672:15672'
    labels:
      NAME: "rabbitmq"
    container_name: rabbitmq
    volumes:
      - 'app_elk_data:/bitnami'
    networks:
      web_network:
        ipv4_address: "10.10.10.5"
    restart:
      always

  elasticsearch:
    build:
      context: ../app_elk/elasticsearch/
      args:
        ELK_VERSION: 7.0.1
    volumes:
      - ../app_elk/elasticsearch/config/elasticsearch.yml:/usr/share/elasticsearch/config/elasticsearch.yml:ro
      - /etc/timezone:/etc/timezone
      - ../app_elk/elasticsearch/data:/usr/share/elasticsearch/data
    ports:
      - "9200:9200"
      - "9300:9300"
    environment:
      ES_JAVA_OPTS: "-Xmx2560m -Xms2560m"
      ELASTIC_PASSWORD: "${ELASTIC_PASSWORD}"
      http.cors.enabled: "true"
      http.cors.allow-origin: "*"
    container_name: elasticsearch
    networks:
      web_network:
        ipv4_address: "10.10.10.6"
    restart:
      always

  kibana:
    build:
      context: ../app_elk/kibana/
      args:
        ELK_VERSION: 7.0.1
    volumes:
      - ../app_elk/kibana/config/kibana.yml:/usr/share/kibana/config/kibana.yml:ro
      - /etc/timezone:/etc/timezone
    ports:
      - "5601:5601"
    networks:
      web_network:
        ipv4_address: "10.10.10.7"
    container_name: kibana
    depends_on:
      - elasticsearch
    restart:
      always

  
volumes:
  app_elk_data:
    external: true
  
networks:
  web_network:
    driver: overlay
    ipam:
      config:
        - subnet: 10.10.10.0/16
          gateway: 10.10.10.1</code></pre>
                        <p class="py-1 font-size-lg mt-2 mb-4 pb-2">There, this is the complete code for the docker compose file.</p>
                        <p class="py-1 font-size-lg mb-4 pb-2">If you go through the code you will notice there six different containers in all. Each service has similar set of keys</p>
                        <ul>
                            <li><code style="font-family: Ubuntu;">build</code></li>
                            <li><code style="font-family: Ubuntu;">command</code></li>
                            <li><code style="font-family: Ubuntu;">volumes</code></li>
                            <li><code style="font-family: Ubuntu;">ports</code></li>
                            <li><code style="font-family: Ubuntu;">environment</code></li>
                            <li><code style="font-family: Ubuntu;">depends_on</code></li>
                            <li><code style="font-family: Ubuntu;">container_name</code></li>
                            <li><code style="font-family: Ubuntu;">networks</code></li>
                            <li><code style="font-family: Ubuntu;">restart</code></li>
                        </ul>
                        <p class="py-1 font-size-lg mt-2 mb-2 pb-2">If you take a closer look at the service <code style="font-family: Ubuntu;">web_db</code> and <code style="font-family: Ubuntu;">rabbitmq</code> you will notice a new set of key <code style="font-family: Ubuntu;">image</code></p>
                        <p class="py-1 font-size-lg mb-2 pb-2">If you remember we had discussed this earlier that instead of build we use the key image for using already created images.</p>
                        <p class="py-1 font-size-lg mb-2 pb-2">This is helpful in case if you don't wish to make any modifications on the existing image. Otherwise there is always the Dockerfile where you can modify as per your requirement</p>
                        <p class="py-1 font-size-lg mt-2 mb-2 pb-2">Next, in the bottom, if you notice there is another top level key <code style="font-family: Ubuntu;">networks</code> and <code style="font-family: Ubuntu;">volumes</code></p>
                        <p>
                            <ul>
                                <li>Networks - will create and attach all the containers in given network name. It also provides all the details about the subnet and gateway and what type of networks should be created</li>
                                <li>Volumes - creates a separate space in the host common to all the containers where you can modify the code and all the changes reflect in realtime. <br> Let's consider a scenario where you need to update your code for new features and development, in normal case you will need to recreate the image, build and re run. <br>In case of volumes you need not to that, the code mapping is already done.</li>
                            </ul>
                        </p>
                        <p class="py-1 font-size-lg mt-2 mb-4 pb-2">Well, Congratulations we have covered all the major important points for you get started with your first application</p>
                        <h5>Summarize</h5>
                        <p class="py-1 font-size-lg mt-2 mb-2 pb-2">Firstly we saw all the command that are required for running a pre-built image and what re most common commands you will need</p>
                        <p class="py-1 font-size-lg mt-2 mb-2 pb-2">We created a Dockerfile, understood the Dockerfile in detail and ran all the basic command to start and terminate the same</p>
                        <p class="py-1 font-size-lg mt-2 mb-2 pb-2">Exporting a running image is easy with just two commands</p>
                        <p class="py-1 font-size-lg mt-2 mb-2 pb-2">Next is Docker Compose, we have saw how it can be helpful while you are running a huge application and has several different dependant services</p>
                        <p class="py-1 font-size-lg mt-2 mb-2 pb-2">How to create a compose file and what the general keys you need to start the container</p>
                        <p class="py-1 font-size-lg mt-2 mb-4 pb-2">The whole of the application, what it needs to do when interacting with multiple containers</p>
                        <h5>Credits</h5>
                        <p class="py-1 font-size-lg mt-2 mb-2 pb-2">I would like to point out the major help I took from the github page where the ELK docker is present <a class="nav-link-style nav-link-style" target="_blank" rel="noopener noreferrer" href="https://github.com/deviantony/docker-elk/blob/main/docker-compose.yml">here</a></p>
                        <p class="py-1 font-size-lg mt-2 mb-4 pb-2"><a class="nav-link-style nav-link-style" target="_blank" rel="noopener noreferrer" href="https://docs.docker.com/compose/compose-file/">Without Docker, this blog does not exists</a></p>
                        <h5>Thank you</h5>
                        <p class="py-1 font-size-lg mt-2 mb-2 pb-2">The raw post is <a class="nav-link-style nav-link-style" target="_blank" rel="noopener noreferrer" href="https://github.com/adityaskarnik/expense_app/wiki">here</a> and <a class="nav-link-style nav-link-style" target="_blank" rel="noopener noreferrer" href="https://github.com/adityaskarnik/docker_commands">here</a> and it has taken a long time for me to come up with it</p>
                        <p class="py-1 font-size-lg mt-2 mb-2 pb-2">Do let me know your feedback and contact me from below links</p>
                        <p class="py-1 font-size-lg mt-2 mb-2 pb-2">✌️</p>
                    </div>
                </div>
            </div>
        </main>
        <footer class="cs-footer bg-dark pt-5 pt-md-6">
            <div class="container pt-3 pt-md-0">
                <div class="row pb-3">
                    <div class="col-md-4 mt-n2 pb-3 pb-md-0 mb-4"><a class="d-block mb-3" href="/" style="width: 153px;"><img class="lazyload" src="../assets/images/logo.png" alt="adityakarnik"></a>
                    <a class="social-btn sb-outline sb-twitter sb-light sb-lg mr-2 mb-2" href="https://linkedin.com/in/adityaskarnik" target="_blank" rel="noopener noreferrer">
                        <i class="fa fa-linkedin" aria-hidden="true"></i>
                    </a>
                    <a class="social-btn sb-outline sb-instagram sb-light sb-lg mr-2 mb-2" href="https://github.com/adityaskarnik" target="_blank" rel="noopener noreferrer">
                        <i class="fa fa-github" aria-hidden="true"></i>
                    </a>
                    <a class="social-btn sb-outline sb-google sb-light sb-lg mr-2 mb-2" href="https://twitter.com/aditya_karnik" target="_blank" rel="noopener noreferrer">
                        <i class="fa fa-twitter" aria-hidden="true"></i>
                    </a>
                    <a class="social-btn sb-outline sb-google sb-light sb-lg mr-2 mb-2" href="https://instagram.com/adityakarnik" target="_blank" rel="noopener noreferrer">
                        <i class="fa fa-instagram" aria-hidden="true"></i>
                    </a>
                    <a class="social-btn sb-outline sb-google sb-light sb-lg mr-2 mb-2" href="mailto:me@adityakarnik.com" target="_blank" rel="noopener noreferrer">
                        <i class="fa fa-envelope" aria-hidden="true"></i>
                    </a>
                    </div>
                </div>
                <p class="logo-text">“Nothing is as important as passion. No matter what you want to do with your life, be passionate.” —Jon Bon Jovi</p>
                <hr class="border-light">
                <div class="row align-items-center my-3 pt-4">
                    <div class="col-md-6 order-md-2 text-md-right mb-3">
                    <ul class="list-inline font-size-sm mb-0">
                        <li class="list-inline-item"><a class="nav-link-style nav-link-light" href="/contact" target="_blank" rel="noopener noreferrer">Contact</a></li>
                        <li class="list-inline-item"><a class="nav-link-style nav-link-light" href="https://www.paypal.com/cgi-bin/webscr?cmd=_s-xclick&hosted_button_id=ZJM97M6KBLHZY" target="_blank" rel="noopener noreferrer">Donate</a></li>
                        <li class="list-inline-item"><a class="nav-link-style nav-link-light" href="/survey" target="_blank" rel="noopener noreferrer">Survey</a></li>
                    </ul>
                    </div>
                    <div class="col-md-6 order-md-1 mb-3">
                        <p class="font-size-sm mb-0"><span class="text-light opacity-50 mr-1">© All rights reserved. Made by</span><a class="nav-link-style nav-link-light" href="https://adityakarnik.com/" target="_blank" rel="noopener noreferrer">Aditya Karnik</a></p>
                    </div>
                </div>
            </div>
          </footer>
          <button class="btn btn-primary btn-sm cs-sidebar-toggle" type="button" data-toggle="offcanvas" data-offcanvas-id="blog-sidebar"><i class="fe-sidebar font-size-base mr-2"></i>Sidebar</button>
        <!-- Back to top button--><a class="btn-scroll-top" href="#top" data-scroll=""><span class="btn-scroll-top-tooltip text-muted font-size-sm mr-2">Top</span><i class="fa fa-arrow-up" aria-hidden="true"></i></a>
        <!-- Vendor scrits: js libraries and plugins-->
        <script>
            window.onload = function () {
                // <link rel="stylesheet" href="../assets/font/font-awesome.min.css">
                // <link rel="stylesheet" href="../assets/font/font-awesome.css">
            }
        </script>
        <script async src="../assets/js/jquery-3.5.1.min.js"></script>
        <script async src="../assets/js/bootstrap.bundle.min.js"></script>
        <script async src="../assets/js/bs-custom-file-input.min.js"></script>
        <script async src="../assets/js/simplebar.min.js"></script>
        <script async src="../assets/js/smooth-scroll.polyfills.min.js"></script>
        <script async src="../assets/js/parallax.min.js"></script>    
        <script async src="../assets/js/tiny-slider.js"></script>
        <script async src="../assets/js/lightgallery.min.js"></script>
        <script async src="../assets/js/lg-video.min.js"></script>
        <script async src="../assets/js/lg-zoom.min.js"></script>
        <script async src="../assets/js/lg-fullscreen.min.js"></script>
        <script src="../assets/js/lazysizes.min.js" async></script>
        <!-- Main theme script-->
        <script async src="../assets/js/theme.min.js"></script>
    </body>
</html>